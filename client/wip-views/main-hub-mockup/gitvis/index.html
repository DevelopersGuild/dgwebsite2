<html>
<head>
  <title></title>
  <script type="text/javascript" src="../d3.min.js"></script>
  <script src="./jquery.min.js"></script>
  <script src="./dgw-git-contributors.json"></script>

<style type="text/css">



</style>
</head>
<body>
<p></p>
<p></p>
<script type="text/javascript">
/*
Info on the API calls necessary:

A separate call is made for each of the following:
- Progress made in the previous work week (two Fridays ago to previous Friday), in order to compare with...
- Progress made in the current work week. (two API calls are needed to work with the 'until' and 'since' parameters)
- Contributors to the repository

Assumptions (for now)
- Desire the progress made since the last DG meeting, and not since exactly one week prior. (hence Friday)
- Most activity is committed to main branch and is otherwise not too convoluted. (this pulls info from all branches)

 */

/*var req = new XMLHttpRequest();
var twoweeks = new Date();

twoweeks.setDate(twoweeks.getDate() - (twoweeks.getDay() + 2) - 7);
console.log(twoweeks);
oneweek = new Date(twoweeks);
oneweek.setDate(oneweek.getDate() + 7)
console.log(twoweeks + ' until ' + oneweek);
req.open('GET', 'https://api.github.com/repos/developersguild/dgwebsite2/commits?sha=master&since=' + twoweeks + '&until=' + oneweek, true);
req.send();

req.onreadystatechange = function(){
  console.log(req.responseText);
}*/

/*var contributions = []

d3.select('body').selectAll('p')
  .data(contributors).enter()
  .append('p').text(function(contributor){
    contributions.push({eval(contributor.login) : new Array()});
    return '@' + contributor.login;
  });

wks_2.forEach(function(c) {
  contributions[c.author.login].push(c);
})

console.log(contributions);
*/

//var cont = d3.select('body').selectAll('svg').append();

// sample, given a project array:
/*projects[0] = [
  {
    eval(login): [
      {
        'date': Date object,
        'message': 'yada',
        'url': 'foo'
      }
    ]
  }
]*/

var Project = function(name) {
  this.name = name;
  this.contributors = {};
}

Project.prototype.appendCommit = function(login, commit) {
  // commit format: date, msg, url
  if (this.contributors[login] == undefined) {
    this.contributors[login] = new Array();

  }
  this.contributors[login].push({
    'date': new Date(commit.date),
    'msg': commit.msg,
    'url': commit.url
  });
}

var dgw = new Project('dgwebsite');
dgw.appendCommit('@a', {'date': new Date(), 'msg': 'yada', 'url': 'sampleurl' })
dgw.appendCommit('@b', {'date': new Date(), 'msg': 'yada', 'url': 'sampleurl' })
dgw.appendCommit('@a', {'date': new Date(), 'msg': 'bada', 'url': 'sampleurl' })

dgw.contributors['@a'].forEach(function(commit) {
  console.log(commit.date)
})

</script>

</body>
</html>
